var I=Object.defineProperty,b=Object.defineProperties;var w=Object.getOwnPropertyDescriptors;var l=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable;var f=(e,n,t)=>n in e?I(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,i=(e,n)=>{for(var t in n||(n={}))$.call(n,t)&&f(e,t,n[t]);if(l)for(var t of l(n))h.call(n,t)&&f(e,t,n[t]);return e},a=(e,n)=>b(e,w(n));const v=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const u of r)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function t(r){const u={};return r.integrity&&(u.integrity=r.integrity),r.referrerpolicy&&(u.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?u.credentials="include":r.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(r){if(r.ep)return;r.ep=!0;const u=t(r);fetch(r.href,u)}};v();function x(e,n){let t=e;return{get:o=>A(t,o),delete:o=>{t=D(t,o),n(t)},add:o=>{const r=N(t,o);return r===t?!1:(t=r,n(t),!0)},update:(o,r)=>{const u=S(t,o,r);return u===t?!1:(t=u,n(t),!0)}}}function A(e,n){return e.filter(t=>t.id===n)[0]}function D(e,n){return e.filter(t=>t.id!==n)}function N(e,n){const t=L(e,n);return g(t)?[...e,t]:e}function S(e,n,t){const o=e.findIndex(u=>u.id===n);if(o<0)return e;const r=a(i(i({},e[o]),t),{doneAt:t.done?new Date:void 0});return g(r)?[...e.slice(0,o),r,...e.slice(o+1)]:e}function L(e,n){return{id:`${e.reduce((r,u)=>Math.max(r,parseInt(u.id,10)),Number.MIN_VALUE)+1}`,name:n,done:!1}}function g(e){return!(!e.id||!e.name)}const y="items";async function F(e){const n=JSON.stringify(e.map(t=>a(i({},t),{doneAt:O(t.doneAt)})));window.localStorage.setItem(y,n)}async function E(){var t;const e=(t=window.localStorage.getItem(y))!=null?t:"[]";return JSON.parse(e).map(o=>a(i({},o),{doneAt:M(o.doneAt)}))}function m(e){return("0"+e).slice(-2)}function O(e){return e?`${e.getFullYear()}-${m(e.getMonth()+1)}-${m(e.getDate())}T00:00:00`:""}function M(e){if(!!e)return new Date(e)}const C=document.querySelector("#app");let c,s;function k(){return`<form class="add-form">
    <input type="text" maxlength="40" />
    <button type="submit" class="add-button">+</button>
  </form>`}function T(e){return`<button class="delete-button" data-id="${e}">\u2716\uFE0F</button>`}function q(e){return e?`${e.getMonth()+1}/${e.getDate()}`:""}function B(e){return`<li class="list-item ${e.done?"done":""}"  data-id="${e.id}">
  <span class="name">\u{1F4CC} ${e.name} ${e.done?"\u2714\uFE0F":""}</span>
  <span class="doneat">${q(e.doneAt)}</span>
  ${T(e.id)}
</li>`}function p(e){C.innerHTML=`
    <ul class="list">
      ${e.map(n=>B(n)).join("")}
    </ul>
    ${k()}
  `,c=document.querySelector(".add-form input[type=text]")}async function P(e){const n=e.dataset.id;if(!n)return;const t=s.get(n);!t||s.update(n,{done:!t.done})}async function H(e){e.preventDefault();const n=c.value;s.add(n)&&(c.value=""),c.focus()}async function J(e,n){e.preventDefault(),e.stopPropagation();const t=n.dataset.id;!t||s.delete(t)}function K(){document.addEventListener("click",e=>{const n=".add-button, .delete-button, .list-item",t=e.target.closest(n);!t||(t.className.includes("add-button")?H(e):t.className.includes("delete-button")?J(e,t):t.className.includes("list-item")&&P(t))})}K();E().then(e=>{s=x(e,async n=>{p(n),await F(n)}),p(e)}).catch(e=>{console.error(e)});
